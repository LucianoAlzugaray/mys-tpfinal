[{"id":"56c6c488.155e8c","type":"tab","label":"Flow 1","disabled":false,"info":""},{"id":"312e7ef4.cf6b52","type":"ui_gauge","z":"56c6c488.155e8c","name":"","group":"aa27139c.9b653","order":0,"width":0,"height":0,"gtype":"gage","title":"Porcentaje de desperdicios","label":"%","format":"{{msg.payload.pedidosEntregados}}","min":0,"max":"10","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":579.0908813476562,"y":180,"wires":[]},{"id":"5f9a3cea.4f0164","type":"function","z":"56c6c488.155e8c","name":"","func":"const pedidosEntregados = Math.round(Math.random()*100);\nconst pedidosRechazados = Math.round(Math.random()*100);\nconst distanciaRecorrida = Math.round(Math.random()*100);\nconst tiempoRecargas = Math.round(Math.random()*100);\nconst pedidosSinTipo = Math.round(Math.random()*100);\n\nconst payload = {\n    \"pedidosEntregados\":pedidosEntregados,\n    \"pedidosRechazados\":pedidosRechazados,\n    \"distanciaRecorrida\":distanciaRecorrida,\n    \"tiempoRecargas\":tiempoRecargas,\n    \"pedidosSinTipo\":pedidosSinTipo\n};\n\nmsg.payload = payload;\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":420,"wires":[["3572dce0.85f154","f97eb14b.08378","a01b32d.84ce9d","8b57f9c9.515a18","8989f14.949251"]]},{"id":"3572dce0.85f154","type":"ui_text","z":"56c6c488.155e8c","group":"5d87b3b.723714c","order":0,"width":0,"height":0,"name":"","label":"Pedidos entregados:","format":"{{msg.payload.pedidosEntregados}}","layout":"row-spread","x":632.9393768310547,"y":363.84847259521484,"wires":[]},{"id":"d8aec00c.92852","type":"ui_template","z":"56c6c488.155e8c","group":"5f4867e2.0f6908","name":"","order":0,"width":"30","height":"2","format":"<div style=\"text-align:center; padding-bottom:2em:\">\n    <h1>\n        Panel de Simulacion\n    </h1>\n</div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":920,"y":160,"wires":[[]]},{"id":"67e85b15.0079d4","type":"ui_dropdown","z":"56c6c488.155e8c","name":"","label":"Volver al restaurante","tooltip":"","place":"Elegir","group":"c6eac339.2efab","order":9,"width":"8","height":"1","passthru":true,"multiple":false,"options":[{"label":"Camioneta mas cercana","value":"1","type":"str"},{"label":"Camioneta mas próxima a liberarse","value":"2","type":"str"}],"payload":"","topic":"","x":960,"y":280,"wires":[["6ba9695c.833fc8"]]},{"id":"9b5d2d08.d78f4","type":"ui_date_picker","z":"56c6c488.155e8c","name":"","label":"Fin","group":"c6eac339.2efab","order":5,"width":"8","height":"1","passthru":true,"topic":"","x":910,"y":240,"wires":[["6ba9695c.833fc8"]]},{"id":"2def999d.4fa606","type":"ui_text_input","z":"56c6c488.155e8c","name":"","label":"Pedidos por hora","tooltip":"","group":"c6eac339.2efab","order":10,"width":"8","height":"1","passthru":true,"mode":"number","delay":300,"topic":"","x":950,"y":320,"wires":[["6ba9695c.833fc8"]]},{"id":"7929d19f.bd52e","type":"ui_text_input","z":"56c6c488.155e8c","name":"","label":"Hornos por camioneta","tooltip":"","group":"c6eac339.2efab","order":6,"width":"8","height":"1","passthru":true,"mode":"number","delay":300,"topic":"","x":960,"y":360,"wires":[[]]},{"id":"f251b34d.3d50b","type":"ui_text_input","z":"56c6c488.155e8c","name":"","label":"Pizzas por horno","tooltip":"","group":"c6eac339.2efab","order":2,"width":"8","height":"1","passthru":true,"mode":"number","delay":300,"topic":"","x":950,"y":400,"wires":[[]]},{"id":"f033aaf6.a6e798","type":"ui_text_input","z":"56c6c488.155e8c","name":"","label":"Cantidad de camionetas","tooltip":"","group":"c6eac339.2efab","order":3,"width":"8","height":"1","passthru":true,"mode":"number","delay":300,"topic":"","x":970,"y":440,"wires":[[]]},{"id":"6add5cd2.13ab64","type":"ui_switch","z":"56c6c488.155e8c","name":"anana","label":"Ananá","tooltip":"","group":"c6eac339.2efab","order":7,"width":"8","height":"1","passthru":true,"decouple":"false","topic":"change-anana","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":1230,"y":520,"wires":[["1558d766.ed4629"]]},{"id":"53730b93.e7eea4","type":"ui_switch","z":"56c6c488.155e8c","name":"","label":"Calabresa","tooltip":"","group":"c6eac339.2efab","order":11,"width":"8","height":"1","passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":1210,"y":580,"wires":[["1558d766.ed4629"]]},{"id":"28a1be22.f74982","type":"ui_switch","z":"56c6c488.155e8c","name":"","label":"Napolitana","tooltip":"","group":"c6eac339.2efab","order":12,"width":"8","height":"1","passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":930,"y":560,"wires":[[]]},{"id":"44832e7f.5ec92","type":"ui_switch","z":"56c6c488.155e8c","name":"","label":"Fugazzeta","tooltip":"","group":"c6eac339.2efab","order":4,"width":"8","height":"1","passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":930,"y":600,"wires":[["6ba9695c.833fc8"]]},{"id":"fbe3072f.875fd8","type":"ui_switch","z":"56c6c488.155e8c","name":"","label":"Mozzarella","tooltip":"","group":"c6eac339.2efab","order":8,"width":"8","height":"1","passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":930,"y":640,"wires":[["6ba9695c.833fc8"]]},{"id":"b4d8ff7e.365ec","type":"ui_template","z":"56c6c488.155e8c","group":"c6eac339.2efab","name":"","order":13,"width":0,"height":0,"format":"<div ng-bind-html=\"msg.payload\" style=\"margin-top:0.25em;\"></div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":920,"y":680,"wires":[[]]},{"id":"19923eb9.ef79b1","type":"ui_table","z":"56c6c488.155e8c","group":"9ef1d40f.078688","name":"","order":0,"width":"32","height":"5","columns":[{"field":"corrida","title":"Corrida","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"esperaClientes","title":"Espera promedio del cliente","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"clientesHora","title":"Clientes atendidos por hora","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"pizzasDia","title":"Pizzas entregadas por dia","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"desperdicios","title":"Porcentaje de desperdicios","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"distanciasRecorridas","title":"Distancia recorrida","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"recargaCamionetas","title":"Tiempo entre recargas","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}}],"outputs":0,"cts":false,"x":610,"y":760,"wires":[]},{"id":"18c975a.8a73d8a","type":"function","z":"56c6c488.155e8c","name":"","func":"let payload = [\n    {\n        \"corrida\":\"1\",\n        \"esperaClientes\":\"10\",\n        \"clientesHora\":\"10\",\n        \"pizzasDia\":\"10\",\n        \"desperdicios\":\"10\",\n        \"distanciasRecorridas\":\"10\",\n        \"recargaCamionetas\":\"10\"    \n    },\n    {\n        \"corrida\":\"2\",\n        \"esperaClientes\":\"20\",\n        \"clientesHora\":\"20\",\n        \"pizzasDia\":\"20\",\n        \"desperdicios\":\"20\",\n        \"distanciasRecorridas\":\"20\",\n        \"recargaCamionetas\":\"20\"    \n    },\n    {\n        \"corrida\":\"3\",\n        \"esperaClientes\":\"30\",\n        \"clientesHora\":\"30\",\n        \"pizzasDia\":\"30\",\n        \"desperdicios\":\"30\",\n        \"distanciasRecorridas\":\"30\",\n        \"recargaCamionetas\":\"30\"    \n    },\n    {\n        \"corrida\":\"4\",\n        \"esperaClientes\":\"40\",\n        \"clientesHora\":\"40\",\n        \"pizzasDia\":\"40\",\n        \"desperdicios\":\"40\",\n        \"distanciasRecorridas\":\"40\",\n        \"recargaCamionetas\":\"40\"    \n    },\n        {\n        \"corrida\":\"5\",\n        \"esperaClientes\":\"50\",\n        \"clientesHora\":\"50\",\n        \"pizzasDia\":\"50\",\n        \"desperdicios\":\"50\",\n        \"distanciasRecorridas\":\"50\",\n        \"recargaCamionetas\":\"50\"    \n    },\n    {\n        \"corrida\":\"6\",\n        \"esperaClientes\":\"60\",\n        \"clientesHora\":\"60\",\n        \"pizzasDia\":\"60\",\n        \"desperdicios\":\"60\",\n        \"distanciasRecorridas\":\"60\",\n        \"recargaCamionetas\":\"60\"    \n    },\n    {\n        \"corrida\":\"7\",\n        \"esperaClientes\":\"70\",\n        \"clientesHora\":\"70\",\n        \"pizzasDia\":\"70\",\n        \"desperdicios\":\"70\",\n        \"distanciasRecorridas\":\"70\",\n        \"recargaCamionetas\":\"70\"    \n    },\n    {\n        \"corrida\":\"8\",\n        \"esperaClientes\":\"80\",\n        \"clientesHora\":\"80\",\n        \"pizzasDia\":\"80\",\n        \"desperdicios\":\"80\",\n        \"distanciasRecorridas\":\"80\",\n        \"recargaCamionetas\":\"80\"    \n    },\n    {\n        \"corrida\":\"9\",\n        \"esperaClientes\":\"90\",\n        \"clientesHora\":\"90\",\n        \"pizzasDia\":\"90\",\n        \"desperdicios\":\"90\",\n        \"distanciasRecorridas\":\"90\",\n        \"recargaCamionetas\":\"90\"    \n    },\n        {\n        \"corrida\":\"10\",\n        \"esperaClientes\":\"100\",\n        \"clientesHora\":\"100\",\n        \"pizzasDia\":\"100\",\n        \"desperdicios\":\"100\",\n        \"distanciasRecorridas\":\"100\",\n        \"recargaCamionetas\":\"100\"    \n    }\n];\nmsg.payload = payload;\nreturn msg;","outputs":1,"noerr":0,"x":400,"y":780,"wires":[["19923eb9.ef79b1"]]},{"id":"8c0d4928.9bcc38","type":"inject","z":"56c6c488.155e8c","name":"","topic":"","payload":"10","payloadType":"num","repeat":"1","crontab":"","once":false,"onceDelay":0.1,"x":170,"y":760,"wires":[["18c975a.8a73d8a"]]},{"id":"6640f9d8.1c8188","type":"inject","z":"56c6c488.155e8c","name":"","topic":"","payload":"10","payloadType":"num","repeat":"1","crontab":"","once":false,"onceDelay":0.1,"x":170,"y":680,"wires":[["4c9c274e.5728e8"]]},{"id":"4c9c274e.5728e8","type":"function","z":"56c6c488.155e8c","name":"","func":"msg.payload = Math.round(Math.random()*100);\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":680,"wires":[["a581b51f.157c38"]]},{"id":"a581b51f.157c38","type":"ui_chart","z":"56c6c488.155e8c","name":"","group":"5d69880b.87fc98","order":1,"width":0,"height":0,"label":"Espera del cliente","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":600,"y":680,"wires":[[]]},{"id":"69a03102.120fb","type":"function","z":"56c6c488.155e8c","name":"","func":"/*\nvar arrayLength = msg.payload.length;\nfor (var i = 0; i <= arrayLength; i++) {\n    var m = {};\n    m.labels = [msg.payload[i].Machine];\n    m.data = [[(msg.payload[i].TotalTime/60).toFixed(2)]];\n    m.series = [\"Total Time in 8 hours by Machine\"];\n    return {payload:[m],topic:msg.topic};\n}\n\n\nlet m = {};\n\nm.labels = [\n    \"Ananá\",\n    \"Calabresa\",\n    \"Fugazzeta\",\n    \"Mozzarella\",\n    \"Napolitana\"\n];\nm.data = [[\n    10,\n    10,\n    10,\n    30,\n    50\n]];\n\nm.series = [\"Tipos de pizza \"];\nmsg.payload = m;\nreturn msg;\n*/\n\nconst opcion = Math.round(Math.random()*100);\nif (opcion < 5){\n    msg.topic = \"Anana\";\n    msg.payload = 10;\n    return msg;\n} else if (opcion < 20) {\n    msg.topic = \"Calabresa\";\n    msg.payload = 20;\n    return msg;\n} else if (opcion < 55) {\n    msg.topic = \"Mozzarella\";\n    msg.payload = 30;\n    return msg;\n} else if (opcion < 75) {\n    msg.topic = \"Fugazzeta\";\n    msg.payload = 20;\n    return msg;\n} else {\n    msg.topic = \"Napolitana\";\n    msg.payload = 20;\n    return msg;\n}","outputs":1,"noerr":0,"x":390,"y":860,"wires":[["fb84886f.4f5068"]]},{"id":"fb84886f.4f5068","type":"ui_chart","z":"56c6c488.155e8c","name":"","group":"dcf5b43e.fe1e08","order":0,"width":0,"height":0,"label":"Ventas por tipo de pizza","chartType":"pie","legend":"true","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":670,"y":860,"wires":[[]]},{"id":"a77acc6b.14fd8","type":"inject","z":"56c6c488.155e8c","name":"","topic":"","payload":"10","payloadType":"num","repeat":"1","crontab":"","once":false,"onceDelay":0.1,"x":170,"y":860,"wires":[["69a03102.120fb"]]},{"id":"f97eb14b.08378","type":"ui_text","z":"56c6c488.155e8c","group":"5d87b3b.723714c","order":0,"width":0,"height":0,"name":"","label":"Pedidos rechazados:","format":"{{msg.payload.pedidosRechazados}}","layout":"row-spread","x":634,"y":400,"wires":[]},{"id":"65382477.13b4ac","type":"ui_template","z":"56c6c488.155e8c","group":"78e543f3.79992c","name":"Footer","order":13,"width":0,"height":0,"format":"<div style=\"paddin-bottom:0.25em;\">\n    <p>Allende Lucila</p>\n    <p>Alzugaray Luciano</p>\n    <p>Ducid Matias</p>\n    <p>Krmpotic Lucas</p>\n</div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":910,"y":780,"wires":[[]]},{"id":"a01b32d.84ce9d","type":"ui_text","z":"56c6c488.155e8c","group":"5d87b3b.723714c","order":0,"width":0,"height":0,"name":"","label":"Distancia Recorrida:","format":"{{msg.payload.distanciaRecorrida}}","layout":"row-spread","x":634,"y":435,"wires":[]},{"id":"8b57f9c9.515a18","type":"ui_text","z":"56c6c488.155e8c","group":"5d87b3b.723714c","order":0,"width":0,"height":0,"name":"","label":"Tiempo entre recargas:","format":"{{msg.payload.tiempoRecargas}}","layout":"row-spread","x":644,"y":471,"wires":[]},{"id":"8989f14.949251","type":"ui_text","z":"56c6c488.155e8c","group":"5d87b3b.723714c","order":0,"width":0,"height":0,"name":"","label":"Pedidos sin tipo en camioneta:","format":"{{msg.payload.pedidosSinTipo}}","layout":"row-spread","x":665,"y":508,"wires":[]},{"id":"a3a7714.e065d9","type":"inject","z":"56c6c488.155e8c","name":"","topic":"","payload":"10","payloadType":"num","repeat":"1","crontab":"","once":false,"onceDelay":0.1,"x":90,"y":180,"wires":[["26df602.9bd0aa"]]},{"id":"26df602.9bd0aa","type":"function","z":"56c6c488.155e8c","name":"","func":"msg.payload = Math.round(Math.random()*10);\nreturn msg;","outputs":1,"noerr":0,"x":280,"y":140,"wires":[["312e7ef4.cf6b52"]]},{"id":"6ef1bacd.dd8e24","type":"inject","z":"56c6c488.155e8c","name":"","topic":"","payload":"10","payloadType":"num","repeat":"1","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":440,"wires":[["5f9a3cea.4f0164"]]},{"id":"f5b40b32.5b2f48","type":"mqtt out","z":"56c6c488.155e8c","name":"iniciar_simulacion","topic":"topic_control","qos":"","retain":"","broker":"514d0deb.6a0354","x":1590,"y":440,"wires":[]},{"id":"2663ab7b.264a84","type":"mqtt in","z":"56c6c488.155e8c","name":"","topic":"topic_data","qos":"2","datatype":"auto","broker":"514d0deb.6a0354","x":80,"y":280,"wires":[["312e7ef4.cf6b52"]]},{"id":"788c0f90.1d0a4","type":"ui_date_picker","z":"56c6c488.155e8c","name":"","label":"Inicio","group":"c6eac339.2efab","order":1,"width":"8","height":"1","passthru":true,"topic":"","x":910,"y":200,"wires":[[]]},{"id":"41d2d537.05850c","type":"debug","z":"56c6c488.155e8c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1550,"y":520,"wires":[]},{"id":"6ba9695c.833fc8","type":"function","z":"56c6c488.155e8c","name":"","func":"\nreturn msg;","outputs":1,"noerr":0,"x":1250,"y":380,"wires":[[]]},{"id":"f1ce669d.6a5218","type":"ui_button","z":"56c6c488.155e8c","name":"","group":"c6eac339.2efab","order":15,"width":0,"height":0,"passthru":false,"label":"INICIAR SIMULACION","tooltip":"","color":"","bgcolor":"","icon":"","payload":"iniciar","payloadType":"str","topic":"action","x":1200,"y":460,"wires":[["1558d766.ed4629"]]},{"id":"1558d766.ed4629","type":"function","z":"56c6c488.155e8c","name":"","func":"let payload = context.get(\"inputs-data\")\nif (msg.topic === 'action'){\n    msg.payload = payload;\n    return msg;\n} else if (msg.topic === 'change-anana') {\n    payload.anana = msg.payload;\n    \n}\n\ncontext.set(\"inputs-data\", msg.payload)\n","outputs":1,"noerr":0,"x":1410,"y":520,"wires":[["41d2d537.05850c"]]},{"id":"b1fe774a.9cf2d8","type":"inject","z":"56c6c488.155e8c","name":"","topic":"inject","payload":"{\"anana\":true}","payloadType":"json","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":1260,"y":340,"wires":[["9cd8f0c5.4b659"]]},{"id":"9cd8f0c5.4b659","type":"function","z":"56c6c488.155e8c","name":"","func":"context.set(\"inputs-data\", msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1440,"y":340,"wires":[[]]},{"id":"aa27139c.9b653","type":"ui_group","z":"","name":"Desperdicio","tab":"1a631a68.7c1e56","order":3,"disp":true,"width":"8","collapse":false},{"id":"5d87b3b.723714c","type":"ui_group","z":"","name":"Indicadores de interés","tab":"1a631a68.7c1e56","order":6,"disp":true,"width":"8","collapse":false},{"id":"5f4867e2.0f6908","type":"ui_group","z":"","name":"TP Final 2020 - UNPSJB","tab":"1a631a68.7c1e56","order":1,"disp":true,"width":"32","collapse":false},{"id":"c6eac339.2efab","type":"ui_group","z":"","name":"Configuracion","tab":"1a631a68.7c1e56","order":2,"disp":true,"width":"32","collapse":true},{"id":"9ef1d40f.078688","type":"ui_group","z":"","name":"Resumen","tab":"1a631a68.7c1e56","order":7,"disp":true,"width":"32","collapse":true},{"id":"5d69880b.87fc98","type":"ui_group","z":"","name":"Espera del Cliente","tab":"1a631a68.7c1e56","order":4,"disp":true,"width":"8","collapse":false},{"id":"dcf5b43e.fe1e08","type":"ui_group","z":"","name":"Tipos de pizza","tab":"1a631a68.7c1e56","order":5,"disp":true,"width":"8","collapse":false},{"id":"78e543f3.79992c","type":"ui_group","z":"","name":"Footer","tab":"1a631a68.7c1e56","order":8,"disp":true,"width":"32","collapse":false},{"id":"514d0deb.6a0354","type":"mqtt-broker","z":"","name":"broker_mosquito","broker":"172.16.240.10","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"1a631a68.7c1e56","type":"ui_tab","z":"","name":"Modelos y Simulación","icon":"dashboard","order":1,"disabled":false,"hidden":false}]
